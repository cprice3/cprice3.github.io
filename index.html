<!DOCTYPE html>
<html>
<head>
    <title>Temperature Monitor</title>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script>
        google.charts.load('current', {
            'packages': ['corechart']
        });
        google.charts.setOnLoadCallback(initialize);

        function initialize() {
            var startDate = new Date();
            startDate.setHours(startDate.getHours() - 12); // Subtract 12 hours from current time
            var startTimestamp = startDate.toISOString();

            var queryString = encodeURIComponent("select B, C, D where B >= timestamp '" + startTimestamp + "' limit 400 label C 'Â°C'");
            var query = new google.visualization.Query(
                'https://docs.google.com/spreadsheets/d/1lkBDiWV8zLEw5IP6J71npqJSLwpoK9ZyNYFPk0W-hIg/gviz/tq?gid=0&headers=1&tq=' + queryString
            );
            query.send(handleSampleDataQueryResponse);
        }

        function handleSampleDataQueryResponse(response) {
            if (response.isError()) {
                alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
                return;
            }

            var data = response.getDataTable();
            displayChart(data);
        }

        function displayChart(data) {
            var options = {
                title: 'Temperature Data',
                curveType: 'function',
                legend: {
                    position: 'bottom'
                },
                hAxis: {
                    format: 'MMM d, HH:mm' // Display day and time on the x-axis
                }
            };

            var chart = new google.visualization.LineChart(document.getElementById('chart'));
            chart.draw(data, options);
        }
    </script>
</head>
<body>
    <div id="chart" style="width: 100%; height: 400px;"></div>
</body>
</html>
